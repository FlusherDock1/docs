---
subtitle: Простой AJAX фреймворк в October CMS.
---
# Введение

October CMS включает в себя фреймворк, предоставляющий полный набор AJAX возможностей, которые позволяют загружать данные с сервера без обновления страницы в браузере. Эту же библиотеку можно использовать в темах CMS и в любом месте бэкенд-панели.

AJAX фреймворк поставляется в двух вариантах: вы можете использовать [API JavaScript] (./javascript-api.md) или [API атрибутов данных] (./attributes-api.md). API атрибутов данных не требует знания JavaScript для использования AJAX с October CMS.

## Подключение AJAX фреймворка

::: aside
Фреймворк AJAX является необязательным в вашем CMS шаблоне, и вы всегда можете вместо него включить любой другой предпочитаемый фреймворк.
:::

При работе с [CMS шаблоном](../../cms/themes/themes.md) подключить AJAX фреймворк используя TWIG очень просто. Поместите тег `{% framework %}` в любом месте вашей страницы или макета. Это добавляет библиотеку JavaScript. Библиотека требует jQuery, поэтому она должна быть загружена первой.

```twig
<script src="{{ 'assets/javascript/jquery.js'|theme }}"></script>

{% framework %}
```

Тег `{% framework %}` поддерживает необязательный параметр **extras**. Если этот параметр указан, тег добавляет файлы CSS и JavaScript для [дополнительных функций](./extras.md), включая валидацию формы, стили пагинации и индикаторы загрузки.

```twig
{% framework extras %}
```

## Как работают AJAX запросы

Страница может выдать запрос AJAX либо по запросу атрибутов данных, либо с помощью JavaScript. Каждый запрос вызывает **обработчик событий** — также называемый [AJAX обработчик] (./handlers.md) — на сервере и может обновлять элементы страницы, используя фрагменты. AJAX запросы лучше всего работают с формами, поскольку данные формы автоматически отправляются на сервер. Вот рабочий процесс запроса:

1. Браузер клиента отправляет запрос AJAX, передавая имя обработчика и другие необязательные параметры.
2. Сервер находит [AJAX обработчик](./handlers.md) и выполняет его.
3. Обработчик выполняет необходимую бизнес-логику и обновляет окружение, вводя переменные страницы.
4. Сервер [рендерит фрагменты](./update-partials.md), запрошенные клиентом с опцией `update`.
5. Сервер отправляет ответ, содержащий обновленные фрагменты.
6. AJAX фреймворк на стороне клиента обновляет элементы страницы новыми фрагментами, полученными в ответе с сервера.

## Пример использования

Ниже приведен простой пример, в котором используется API атрибутов данных для определения формы с поддержкой AJAX. Форма отправит запрос AJAX к обработчику **onTest** и запросит обновление элемента с результатами фрагментом **mypartial**.

::: tip
Данные формы `value1` и `value2` автоматически отправляются с запросом AJAX.

```html
<!-- AJAX форма -->
<form data-request="onTest" data-request-update="mypartial: '#myDiv'">

    <!-- Два инпута с параметрами -->
    <input name="value1"> + <input name="value2">

    <!-- Кнопка отправки -->
    <button type="submit">Расчитать</button>

</form>

<!-- Элемент для результата -->
<div id="myDiv"></div>
```
:::

Фрагмент **mypartial** содержит разметку, которая считывает переменную `result`.

```twig
Результат: {{ result }}
```

Обработчик **onTest** обращается к данным формы с помощью `input` [вспомогательного метода](../../extend/services/helpers.md), и результат передается в переменную страницы `result`.

```php
function onTest()
{
    $this->page['result'] = input('value1') + input('value2');
}
```

Пример можно прочитать так: «Когда форма отправлена, отправьте запрос AJAX обработчику **onTest**. Когда обработчик закончит работу, возьмите фрагмент **mypartial** и вставьте его содержимое в **элемент #myDiv**."

#### Смотрите также

::: also
* [JavaScript API](./javascript-api.md)
* [API атрибутов данных](./attributes-api.md)
* [Дополнительные возможности фреймворка](./extras.md)
:::
